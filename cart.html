<!DOCTYPE html>
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" class="flexNav-no-touch" lang="en">
<head>
	<meta content="text/html; charset=UTF-8" http-equiv="content-type">
	<meta content="text/javascript" http-equiv="content-script-type">
	<meta content="0" http-equiv="expires">
	<meta content="no-cache" http-equiv="pragma">
	<meta content="no-cache, must-revalidate" http-equiv="cache-control">
	<meta content="initial-scale=1.0, user-scalable=1" name="viewport">
	<script src="w3cPayment2.js" type="text/javascript"></script>

	<title>Checkout Page</title>
	</head>
<style type="text/css">
		
<style>
table, td, th {    
    text-align: left;
}

table {
    border-collapse: collapse;
    width: 100%;
}

th, td {
    border: 1px solid black;
    padding: 15px;
}
	
.photo{
    text-align: center;
    background-color: white; 
	}
	
.delete{
    border: none;
        }
	
.button{
    background-color: transparent;
    background-repeat:no-repeat;
    border: none;
    cursor:pointer;
    overflow: hidden;
    outline:none;
}	
	
</style>
	<body style="background-image:url(bg.png); z-index: -1;">

		<script>
	var url = new URL(window.location.href);
	var c = url.searchParams.get("numcard");
	console.log(c);
	</script>
	
<div class="commande" style="width:75%; position:absolute; top:15%; left:15%;">
<table id="recap">
   <tr>
       <th style="background-color:white; ">Produit</th>
       <th style="background-color:white; ">Description</th>
       <th style="background-color:white; ">Prix</th>
	   <th class="delete"> </th>
   </tr>

   <tr>
       <td class='photo'><img src="basket.jpg" width="50" height="50"></td>
       <td  style="background-color:white; ">Ballon de basket</td>
       <td  style="background-color:white; "id="article1">12.00</td>
	   <td class="delete"><button id="del1" onclick="deleteArticle(this);"><img src="del.png" width="30" height="30"></button></td>
   </tr>
   <tr>
       <td class='photo'><img src="panier.jpg" width="50" height="50"></td>
       <td  style="background-color:white;">Panier de basket</td>
       <td  style="background-color:white;" id="article2">80.00</td>
	   <td class="delete"> <button id="del2" onclick="deleteArticle(this);"><img src="del.png" width="30" height="30"></button> </td>
   </tr>
</table>
	<div class="total" id="total" style="text-align:right;">
		<p id="totalAmount"><font color="white"></font></p>
	</div class="delete">
</div>
<p class="img">
	<p style="position: absolute; left: 400px; top: 410px"> Install and try: </p>
	<a href="recommendedapp/index.html">
		<img class="left" src="recommendedapp/bgPaylib.png" alt="" title="" style="width: 50px; height: 30px;position: absolute;
left: 65%;
top: 422px;  z-index: 1;" />
	</a>
</p>
	<div class="autreArticle" style="position:absolute;top:70%; left:35%;>
	<p style="text-align:center;position:absolute;top:;left:;">
	<p> Articles pouvant vous intéresser </p>
	<button class="button" id="art3" onclick="addArticle(2,'Article 3', '65.00');"><img src="chaussures.jpg" width="100" height="100"></button>
	<button class="button" id="art4" onclick="addArticle(3,'Article 4', '17.00');"><img src="bandeau.jpg" width="100" height="100"></button>
	</p>
	</div>
														       
 	<button id="payer" onclick="payer();"> Payer </button>
	<script>
	calculTotal();
		
	function deleteArticle(id){
		id.parentNode.parentNode.parentNode.removeChild(id.parentNode.parentNode);
		calculTotal();
	}
		
    function addArticle(id,art,value){
    var rowCount = document.getElementById('recap').rows.length;
    var name = rowCount+1;
    var elmt = document.getElementById("recap");
    var tr = document.createElement('tr');
    elmt.appendChild(tr);
     
    var td = document.createElement('td');
    td.style.backgroundColor="white";
    tr.appendChild(td);
    var tdText = document.createTextNode("");
    td.appendChild(tdText);

    var tdDesc = document.createElement('td');
    tdDesc.style.backgroundColor ="white";
    tr.appendChild(tdDesc);
    var tdTextDesc = document.createTextNode(art);
    tdDesc.appendChild(tdTextDesc);
			
    var tdPrix = document.createElement('td');
    tdPrix.id = 'article'+name;
    tdPrix.style.backgroundColor="white";
    tr.appendChild(tdPrix);
    var tdTextPrix = document.createTextNode(value);
    tdPrix.appendChild(tdTextPrix);
			
    var tdDel = document.createElement('td');
    tr.appendChild(tdDel);
    var del = document.createElement('BUTTON');
    del.onclick= function () {
	deleteArticle(this);
};
    tdDel.appendChild(del);
    var img = new Image(30,30); // width, height values are optional params 
    img.src = 'del.png';
    del.appendChild(img);
    
    calculTotal();
		}
	
		function calculTotal(){
			var table = document.getElementById('recap');
			var rowCount = document.getElementById('recap').rows.length;
			console.log(rowCount);
			var total = document.getElementById("totalAmount");
			var amount = 0;
			for (i=1;i<rowCount;i++){
				amount= amount + parseFloat(table.rows[i].cells[2].innerHTML);
			}
			total.innerHTML ="Total : " + amount + " €";
		}
		
//var mList = document.getElementById("methodList");
	
function getAmount() {	
	var table = document.getElementById('recap');
	var rowCount = document.getElementById('recap').rows.length;
	var total = document.getElementById("totalAmount");
	var amount = 0;
	for (i=1;i<rowCount;i++){
		amount= amount + parseFloat(table.rows[i].cells[2].innerHTML);
		} 
	return amount
};
		
function payer(){
if (window.PaymentRequest) {
	var amount = getAmount();
	var url = new URL(window.location.href);
	//mList.style.display="none";
		launchPayment(['amex', 'visa', 'mastercard'],amount);
	}
}
	
				    
function nextPage(payMethod,payMean,address) {
	//var div1 = document.getElementById("onClickMessage");
	//var div2 = document.getElementById("onClickOverlay");
	//div2.style.display='inline';
	//div1.style.display='inline';
window.setTimeout(function() {
		//window.location.href = 'http://localhost/POCw3c/sips/receipt.php?tId='+tId+'&payMethod='+payMethod+'&payMean='+payMean+'';
	
    var form = document.createElement("form");
    var element1 = document.createElement("input"); 
    var element2 = document.createElement("input");  
    var element3 = document.createElement("input");
    var element4 = document.createElement("input");
    form.method = "POST";
    form.action = "https://rd.atosworldline.com/qualif/POCw3c/receipt.php";   
    element1.type="hidden";
    element1.value=payMethod;
    element1.name="payMethod";
    form.appendChild(element1);  
    element2.type="hidden";
    element2.value=payMean;
    element2.name="payMean";
    form.appendChild(element2);
	
    element3.type="hidden";
    element3.value=tId;
    element3.name="tId";
    form.appendChild(element3);
	
    element4.type="hidden";
    element4.value=address;
    element4.name="address";
    form.appendChild(element4);
    document.body.appendChild(form);
    form.submit();
}, 1000);
	
}
	</script>	
</body>
</html>
