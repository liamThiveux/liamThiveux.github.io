
<html lang="en">
 
 <head>
     <meta charset="utf-8">
     <meta name="viewport" content="width=device-width, initial-scale=1">
     <title>Payment Handler for Paylib</title>
     <link rel="icon" href="/favicon.ico">

 </head>
 <style type="text/css">
body, html {
    height: 100%;
}
.bg { 
    /* The image used */
    background-image: url("loginPage.png");
    /* Full height */
    height: 100%; 
    /* Center and scale the image nicely */
    background-position: center;
    background-repeat: no-repeat;
    background-size: cover;
}
.contents {
    position: absolute;
    top: 70%;
    left: 30%;
    transform: translate(-50%, -50%);
  }
  </style>
  
 <body>
  <div class="bg">
    <p style='position:absolute; top:3px; left:62%;' id='price'><font color='white' size='6'></font></p>
    <button style="position: absolute; left:40%; top:56%; width:200px; height:40px;" id="valider" onclick="clickMe()">Valider </button>
   <form method="GET" action="../sips/receipt.html">
    <input type="text" id="login" placeholder="Login" style="position:absolute; left:27%; top:40%; width:150px; height:25px;">
    <input type="password" id="password" placeholder="Password" style="position:absolute; left:27%; top:44%; width:150px; height:25px; display:none;">
    <button type="submit" id="submit">Submit </button>
   </form>
    <button style="position: absolute; left:40%; top:58%; width:200px; height:40px; display:none;" id="send" onclick="sendData()"> Send</button>
  </div>
  
  <script type="text/javascript" src="../sips/w3CPayment.js"></script>
  <script>
   window.addEventListener("message", receiveMessage, false);
   function receiveMessage(event)
   {
     console.log("Hey message re√ßu");
    event.postMessage(event.source);
   }
   console.log(window.my_amount);
   window.onload = fillPrice;
   
    function fillPrice(){
    console.log("in fill price");
    var url_string = window.location.href; //window.location.href
    var url = new URL(url_string);
    var total = url.searchParams.get("total");
    console.log(total);
    document.getElementById("price").innerHTML ="Price : " + total;
    }
  
   
   function clickMe(){
    console.log("dans la function");
    document.getElementById("password").style.display = "block";
    document.getElementById("valider").style.display = "none";
    document.getElementById("send").style.display = "block";
   }
   
    function sendData(){
     var payMethod="Paylib";
     var payMean="Liam_Card";
     console.log("dans sendData");
 let networks = ['amex', 'diners', 'discover', 'jcb', 'mastercard', 'unionpay','visa', 'mir'];
 let types = ['debit', 'credit', 'prepaid'];
 let supportedInstruments = [
	{
		supportedMethods: 'basic-card',
		data: {
			supportedNetworks: networks, 
			supportedTypes: types
		}
	},
	{
		supportedMethods: 'bobpay',
		data: {
			supportedNetworks: networks,
			supportedTypes: types
		}	
	},
	{
		supportedMethods: 'https://liamThiveux.github.io',
	  	data : {
	  		merchantIdentifier: "Liam",
	  		bobPaySpecificField: true
	  	}
	}
  ];
  let details = {
    total: {label: 'Montant de la transaction', amount: {currency: 'EUR', value: '23.20'}},
    displayItems: [
      {
        label: 'Montant de la transaction',
        amount: {currency: 'EUR', value: '23.20'},
      },
    ],
  };
            
        var test = new PaymentRequest(supportedInstruments, details);
     	var paymentRep = {
		requestId: "123456789",
		methodName: "https://liamThiveux.github.io",
		details: "nothing",
		function complete(){}
	};
	sendPaymentToServer(paymentRep);
        //sendPaymentToServer(payment);                 
           // window.open("https://liamThiveux.github.io/sips/receipt");
        }
  </script>
  </body>
</html>
