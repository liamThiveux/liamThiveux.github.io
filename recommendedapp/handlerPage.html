<html>
<head>
</head>
<body>
<form id="form">
<table>
  <tr><th>Cardholder Name:</th><td><input name="cardholderName"></td></tr>
  <tr><th>Card Number:</th><td><input name="cardNumber"></td></tr>
  <tr><th>Expiration Month:</th><td><input name="expiryMonth"></td></tr>
  <tr><th>Expiration Year:</th><td><input name="expiryYear"></td></tr>
  <tr><th>Security Code:</th><td><input name="cardSecurityCode"></td></tr>
  <tr><th></th><td><input type="submit" value="Pay"></td></tr>
</table>
</form>

<script>
  console.log("hello");
 // console.log(e.source);
  
  window.addEventListener("message", function(e) {
  var form = document.getElementById("form");
  /* Note: message sent from payment app is available in e.data */
  form.onsubmit = function() {
    /* See https://w3c.github.io/payment-handler/#paymenthandlerresponse-dictionary */
    var cardholder = document.getElementsByName("cardholderName")[0].value;    
    console.log(cardholder);
    var cardnumber = document.getElementsByName("cardNumber")[0].value;
    var cardnumber = document.getElementsByName("cardNumber")[0].value;
    var expiration = document.getElementsByName("expiryMonth")[0].value + "/" + document.getElementsByName("expiryYear")[0].value;
    var crypto = document.getElementsByName("cardSecurityCode")[0].value;
    var paymentAppResponse = {
      methodName: "https://liamThiveux.github.io",
       details: {
      cardHolderName:   cardholder,
      cardNumber:       cardnumber,
      expiration: expiration,
      cardSecurityCode: crypto
     }
    };

    e.source.postMessage(paymentAppResponse);
    window.close();
  }
});
  
  console.log("didn't work");
</script>
  </body>
</html>
